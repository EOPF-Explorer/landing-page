import{ax as R,a2 as P,ay as N,q as Y,p as T,v as j,o as i,c as k,E as v,az as q,w as d,j as m,a0 as g,b as h,k as o,e as c,K as U,W as H,h as K,au as O}from"./framework.C7uZQbdX.js";import{_ as W,U as G,n as y,f as D,af as J,u as L,ag as Q,ah as b,ai as x,aj as X,ak as Z,al as ee}from"./eo-dash.Cz_OgVWV.js";import{c as A,d as I}from"./mdi.CnJQHbhh.js";import{T as w}from"./index-C5npyZY6.DktgnbBd.js";import"./item.Bx-rtsOD.js";import"./commonjsHelpers.BosuxZz1.js";import"./VTooltip-CifBbpCx.BPVQSguD.js";import"./forwardRefs-64mgSLjK.CNcz1d98.js";import"./transition-BwFOaDL9.9Bvbrg4C.js";const te=".vc-popover-content{--vc-nav-hover-bg: rgba(var(--v-theme-on-surface), .1);--vc-nav-item-active-color: rgb(var(--v-theme-on-secondary));--vc-nav-item-active-bg: rgba(var(--v-theme-secondary), .8);--vc-focus-ring: 0 0 0 2px rgba(var(--v-theme-secondary), .5)}.vc-container{--vc-day-content-hover-bg: rgba(var(--v-theme-on-surface), .2);--vc-focus-ring: 0 0 0 2px rgba(var(--v-theme-secondary), .4);--vc-header-arrow-hover-bg: rgba(var(--v-theme-secondary), .1)}.vc-attr{--vc-accent-600: rgba(var(--v-theme-secondary), .8)}.datePicker{--vc-day-content-hover-bg: red}@media(min-width:960px){.datePicker{position:absolute;bottom:0;left:0;right:0;margin-inline:auto;width:fit-content}}.vc-day-content{color:#5e5e5e;font-weight:400}.vc-highlight-content-solid{color:#fff!important}.vc-popover-content-wrapper{transform:var(--v5270a4d4)!important}.vc-date-picker-content,.datePicker{backdrop-filter:blur(10px)!important;border-radius:8px;border:none;box-shadow:0 0 1px #18274b38,0 6px 12px -6px #18274b1f,0 8px 24px -4px #18274b14;background-color:rgba(var(--v-theme-surface),var(--v-surface-opacity, .8))!important}.vc-popover-caret.direction-top.align-left{clip-path:polygon(0% 0%,100% 0%,0% 100%,0% 100%)}.vc-bordered{border:none}",ae={ref:"rootRef",class:"datePicker"},re={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},oe={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ne=["value"],se={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ie={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},le=["value"],de={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(s){R(a=>({v5270a4d4:S.value}));const{lgAndDown:f}=G(),_=P("rootRef"),z=P("datePicker"),u=N((a,e)=>({get(){return a(),new Date(D.value).getTime()},set(t){var n;e(),y.debug("Datepicker setting currentDate",D.value);const r=new Date(t);if(isNaN(r.getTime())){y.warn("Invalid date value provided to datepicker:",t);return}D.value=r.toISOString(),(n=z.value)==null||n.move({month:r.getMonth()+1,year:r.getFullYear()})}})),E=T({input:"YYYY-MM-DD"}),M=a=>{const e=a.getFullYear(),t=a.getMonth()+1,r=a.getDate();return`${e}-${t<10?"0"+t:t}-${r<10?"0"+r:r}`},V=a=>{var e;u.value=new Date((e=a.target)==null?void 0:e.value).getTime()},$=K(()=>M(new Date(u.value))),l=O([]),{selectedCompareStac:B,selectedStac:F}=J(L());Y([F,B],async([a,e])=>{if(l.splice(0,l.length),!a&&!e){y.debug("No STAC selected, clearing datepicker attributes");return}const t=[...await C(Z),...await C(ee)];l.push(...t)},{immediate:!0});async function C(a){return!a||!a.length?[]:await Promise.all(a.map((e,t)=>e.fetchCollection().then(async()=>{var n;const r=await e.getDates();if(!r||!r.length){y.debug(`Collection ${(n=e.collectionStac)==null?void 0:n.id} has no dates, skipping datepicker attribute`);return}return{key:"id-"+t.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:e.color}},dates:r,content:{style:{color:"#000000","font-weight":"bold"}}}})))}function p(a){if(l.length){let e=a?1/0:-1/0;l.forEach(t=>{t!=null&&t.dates&&t.dates.forEach(r=>{r instanceof Date&&(e=Math[a?"min":"max"](e,r.getTime()))})}),u.value=e===-1/0?Date.now():e===1/0?0:e}}const S=T("");return j(()=>{S.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),Q(_),(a,e)=>(i(),k("div",ae,[v(o(X),{ref:"datePicker",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=t=>u.value=t),modelModifiers:{number:!0},attributes:l,masks:E.value,expanded:"",class:"overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},q({_:2},[s.toggleCalendar?{name:"default",fn:d(({inputValue:t,inputEvents:r})=>[m("div",re,[s.hideArrows?c("v-if",!0):g((i(),h(b,{key:0,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=n=>p(!0)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:d(()=>[v(x,{icon:[o(A)]},null,8,["icon"])]),_:1},8,["size"])),[[w,"Set date to oldest available dataset","bottom"]]),m("div",oe,[s.hideInputField?c("v-if",!0):(i(),k("input",U({key:0,value:t},H(r,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,ne))]),s.hideArrows?c("v-if",!0):g((i(),h(b,{key:1,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=n=>p(!1)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:d(()=>[v(x,{icon:[o(I)]},null,8,["icon"])]),_:1},8,["size"])),[[w,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:d(()=>[m("div",se,[s.hideArrows?c("v-if",!0):g((i(),h(b,{key:0,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=t=>p(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[v(x,{icon:[o(A)]},null,8,["icon"])]),_:1},8,["size"])),[[w,"Set date to oldest available dataset","bottom"]]),m("div",ie,[s.hideInputField?c("v-if",!0):(i(),k("input",{key:0,value:$.value,onChange:V,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,le))]),s.hideArrows?c("v-if",!0):g((i(),h(b,{key:1,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=t=>p(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[v(x,{icon:[o(I)]},null,8,["icon"])]),_:1},8,["size"])),[[w,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}},be=W(de,[["styles",[te]]]);export{be as default};
