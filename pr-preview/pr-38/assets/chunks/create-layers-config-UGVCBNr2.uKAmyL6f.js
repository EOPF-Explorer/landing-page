import{l as L,b8 as d}from"./eo-dash.9F2a4VwJ.js";const v=async(o,n,a)=>{L.debug("Creating layers config",o,n,a);const p=[],y={type:"Group",properties:{id:"AnalysisGroup",title:"Data Layers",layerControlExpand:!0},layers:[]};for(const s of n){let e,r;a?(typeof a=="string"&&a.includes("/")?r=a:r=typeof a=="string"?new Date(a):a,e=await s.createLayersJson(r)):e=await s.createLayersJson(void 0),e.forEach(i=>{i.properties.layerControlExpand=!0,i.properties.layerControlToolsExpand=!0}),y.layers.push(...e)}if(o!=null&&o.links){const s=o.links.filter(e=>Array.isArray(e.roles)&&(e.roles.includes("disable")||e.roles.includes("hidden")));s.length>0&&s.forEach(e=>{const r=e.id,i=y.layers.find(h=>h.properties.id.split(";:;")[0]===r);i&&(Array.isArray(e.roles)&&e.roles.includes("disable")?i.properties.visible=!1:Array.isArray(e.roles)&&e.roles.includes("hidden")&&(i.properties.layerControlHide=!0))})}p.push(y);const f=await d.getIndicatorLayers(o),u=d.getObservationPointsLayer(n);u&&y.layers.push(u);const l={type:"Group",properties:{id:"BaseLayersGroup",title:"Base Layers"},layers:[]},t=f.filter(s=>s.properties.group==="baselayer");if(t.length){let s=0,e=0;for(let r=0;r<t.length;r++){const i=t[r];"visible"in i.properties||(i.properties.visible=!1),i.properties.visible&&(s++,e=r)}s===0&&(t[0].properties.visible=!0),s>0&&t.forEach((r,i)=>{i!==e?r.properties.visible=!1:r.properties.visible=!0}),l.layers.push(...t),l.layers.forEach(r=>{r.properties.layerControlExclusive=!0})}else l.layers.push({type:"Tile",properties:{id:"osm",title:"Background",layerControlExclusive:!0},source:{type:"OSM"}});l.layers.length&&p.unshift(l);const c={type:"Group",properties:{id:"OverlayGroup",title:"Overlay Layers"},layers:[]},g=f.filter(s=>s.properties.group==="overlay");return g.length&&(c.layers.push(...g),p.push(c)),p};export{v as c};
