import{h as f,t as A,g as U,s as v,w as P,q as E}from"./utils.B30GSCAo.js";import{N as $,O as k,D as q,B as D,w as H}from"./runtime-core.esm-bundler.MgDDUQih.js";const B=Symbol(),L="http://a.com",I=()=>({path:"/",component:null,data:E});function W(e,a){const c=$(I()),n={route:c,go:d};async function d(t=f?location.href:"/"){var o,u;t=R(t),await((o=n.onBeforeRouteChange)==null?void 0:o.call(n,t))!==!1&&(f&&t!==R(location.href)&&(history.replaceState({scrollPosition:window.scrollY},""),history.pushState({},"",t)),await h(t),await((u=n.onAfterRouteChange??n.onAfterRouteChanged)==null?void 0:u(t)))}let s=null;async function h(t,o=0,u=!1){var w,m;if(await((w=n.onBeforePageLoad)==null?void 0:w.call(n,t))===!1)return;const i=new URL(t,L),l=s=i.pathname;try{let p=await e(l);if(!p)throw new Error(`Page not found: ${l}`);if(s===l){s=null;const{default:r,__pageData:b}=p;if(!r)throw new Error(`Invalid route component: ${r}`);await((m=n.onAfterPageLoad)==null?void 0:m.call(n,t)),c.path=f?l:P(l),c.component=k(r),c.data=k(b),f&&q(()=>{let g=v.value.base+b.relativePath.replace(/(?:(^|\/)index)?\.md$/,"$1");if(!v.value.cleanUrls&&!g.endsWith("/")&&(g+=".html"),g!==i.pathname&&(i.pathname=g,t=g+i.search+i.hash,history.replaceState({},"",t)),i.hash&&!o){let y=null;try{y=document.getElementById(decodeURIComponent(i.hash).slice(1))}catch(T){console.warn(T)}if(y){_(y,i.hash);return}}window.scrollTo(0,o)})}}catch(p){if(!/fetch|Page not found/.test(p.message)&&!/^\/404(\.html|\/)?$/.test(t)&&console.error(p),!u)try{const r=await fetch(v.value.base+"hashmap.json");window.__VP_HASH_MAP__=await r.json(),await h(t,o,!0);return}catch{}if(s===l){s=null,c.path=f?l:P(l),c.component=a?k(a):null;const r=f?l.replace(/(^|\/)$/,"$1index").replace(/(\.html)?$/,".md").replace(/^\//,""):"404.md";c.data={...E,relativePath:r}}}}return f&&(history.state===null&&history.replaceState({},""),window.addEventListener("click",t=>{if(t.defaultPrevented||!(t.target instanceof Element)||t.target.closest("button")||t.button!==0||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return;const o=t.target.closest("a");if(!o||o.closest(".vp-raw")||o.hasAttribute("download")||o.hasAttribute("target"))return;const u=o.getAttribute("href")??(o instanceof SVGAElement?o.getAttribute("xlink:href"):null);if(u==null)return;const{href:i,origin:l,pathname:w,hash:m,search:p}=new URL(u,o.baseURI),r=new URL(location.href);l===r.origin&&A(w)&&(t.preventDefault(),w===r.pathname&&p===r.search?(m!==r.hash&&(history.pushState({},"",i),window.dispatchEvent(new HashChangeEvent("hashchange",{oldURL:r.href,newURL:i}))),m?_(o,m,o.classList.contains("header-anchor")):window.scrollTo(0,0)):d(i))},{capture:!0}),window.addEventListener("popstate",async t=>{var u;if(t.state===null)return;const o=R(location.href);await h(o,t.state&&t.state.scrollPosition||0),await((u=n.onAfterRouteChange??n.onAfterRouteChanged)==null?void 0:u(o))}),window.addEventListener("hashchange",t=>{t.preventDefault()})),n}function x(){const e=D(B);if(!e)throw new Error("useRouter() is called without provider.");return e}function Y(){return x().route}function _(e,a,c=!1){let n=null;try{n=e.classList.contains("header-anchor")?e:document.getElementById(decodeURIComponent(a).slice(1))}catch(d){console.warn(d)}if(n){let d=function(){!c||Math.abs(h-window.scrollY)>window.innerHeight?window.scrollTo(0,h):window.scrollTo({left:0,top:h,behavior:"smooth"})};const s=parseInt(window.getComputedStyle(n).paddingTop,10),h=window.scrollY+n.getBoundingClientRect().top-U()+s;requestAnimationFrame(d)}}function R(e){const a=new URL(e,L);return a.pathname=a.pathname.replace(/(^|\/)index(\.html)?$/,"$1"),v.value.cleanUrls?a.pathname=a.pathname.replace(/\.html$/,""):!a.pathname.endsWith("/")&&!a.pathname.endsWith(".html")&&(a.pathname+=".html"),a.pathname+a.search+a.hash}const j=e=>{_paq.push(["trackEvent",...e])},F=e=>{_paq.push(["rememberCookieConsentGiven"]),C(!1),S(!0,e)},M=e=>{_paq.push(["forgetCookieConsentGiven"]),_paq.push(["optUserOut"]),C(!1),S(!1,e)},C=e=>{document.querySelector(".cookie-banner").style.display=e?"block":"none"},S=(e,a)=>{K(e,a),N(a)},K=(e,a)=>{function c(){const s=document.documentElement,h=document.body,t="scrollTop",o="scrollHeight";return(s[t]||h[t])/((s[o]||h[o])-s.clientHeight)*100}const n={25:[],50:[],75:[],100:[]},d=()=>{Object.keys(n).forEach(s=>{c()>=parseInt(s)&&!n[s].includes(a.route.path)&&(n[s].push(a.route.path),j(["Interaction","Scroll Depth",a.route.path,`${s}%`]))})};e?document.addEventListener("scroll",d):document.removeEventListener("scroll",d)},N=e=>{H(()=>e.route.data.relativePath,()=>{document.cookie.includes("mtm_cookie_consent")&&(_paq.push(["setCustomUrl",e.route.path]),_paq.push(["setDocumentTitle",e.route.data.title]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]))},{immediate:!0})};export{B as R,x as a,F as b,W as c,M as d,S as e,C as s,j as t,Y as u};
