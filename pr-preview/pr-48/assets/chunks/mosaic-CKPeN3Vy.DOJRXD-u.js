import{k as m,n,B as p,m as l,i as f}from"./eo-dash.Bm2TOzVk.js";import{I as L}from"./item.Bx-rtsOD.js";import{v as M,x as h}from"./framework.CUjv93hf.js";async function w(a,e){return f.value==="sentinel-2-l2a"?{links:[{rel:"XYZ",href:"https://api.explorer.eopf.copernicus.eu/openeo/services/xyz/456c1e23-47f2-4567-98cf-dcde378a05f7/tiles/{z}/{x}/{y}"}]}:null}async function v(a,e,s,t){const o=await w();if(!o||f.value!=="sentinel-2-l2a")return[];const c=new L(o).links.find(i=>i.rel==="XYZ");if(!c)return[];let r=c.href;if(s){const i=new URLSearchParams;i.set("time",'["'+s[0].split("T")[0]+'","'+s[1].split("T")[0]+'"]'),r.includes("?")?r=r+"&"+i.toString():r=r+"?"+i.toString(),console.log("[eodash] Mosaic layer URL:",r)}return n.latestLayer={type:"Tile",properties:{id:"Mosaic"+Date.now(),title:"Sentinel-2 L2A Mosaic"},source:{type:"XYZ",url:r}},[n.latestLayer]}function d(a){let e=a.find(s=>{var t;return((t=s==null?void 0:s.properties)==null?void 0:t.id)==="AnalysisGroup"});return e||(e={type:"Group",properties:{id:"AnalysisGroup",title:"Data Layers"},layers:[]},a.push(e)),{layers:a,analysisGroup:e}}async function S(a,e,s,t){const o=p(),{analysisGroup:u,layers:c}=d(o),r=await v(a,e,s);r.length&&(u.layers=r,n.showButton=!1,l.value&&(l.value.layers=[...c]),console.log("[eodash] Mosaic layer rendered."))}async function G(a,{timeRange:e,collection:s}={},t){await S(a,void 0,e)}function B(){if(!n.latestLayer)return;const a=p(),{analysisGroup:e,layers:s}=d(a);e.layers=[n.latestLayer],l.value&&(l.value.layers=[...s])}async function y(a,{timeRange:e,collection:s}={},t){await G(a,{...s&&{collection:s},...e&&{timeRange:e}}),n.showButton=!1}function U(a,{timeRange:e}={},s){M(async()=>{var t;y(a,{collection:(t=s.selectedStac)==null?void 0:t.id,timeRange:e})}),m(()=>{var t;y(a,{collection:(t=s.selectedStac)==null?void 0:t.id,timeRange:e})}),h(()=>{n.showButton=!1})}export{y as i,B as r,U as u};
