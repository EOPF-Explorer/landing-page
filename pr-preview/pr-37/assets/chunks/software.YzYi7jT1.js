window.waitForOpenLayers=function(){return new Promise(e=>{if(typeof window.ol<"u"){e();return}const o=setInterval(()=>{typeof window.ol<"u"&&(clearInterval(o),e())},100);setTimeout(()=>{clearInterval(o),console.error("OpenLayers failed to load within 10 seconds"),e()},1e4)})};window.createCopyUrlFunction=function(e){return function(o,t){const n=e();if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(n).then(()=>{o.value="âœ… Copied!",t.value="copy-button copied",setTimeout(()=>{o.value="ðŸ“‹ Copy URL",t.value="copy-button"},2e3)}).catch(r=>{console.error("Failed to copy: ",r),o.value="âŒ Failed",setTimeout(()=>{o.value="ðŸ“‹ Copy URL"},2e3)});else{const r=document.createElement("textarea");r.value=n,r.style.position="fixed",r.style.left="-999999px",r.style.top="-999999px",document.body.appendChild(r),r.focus(),r.select();try{document.execCommand("copy"),o.value="âœ… Copied!",t.value="copy-button copied",setTimeout(()=>{o.value="ðŸ“‹ Copy URL",t.value="copy-button"},2e3)}catch(a){console.error("Fallback copy failed: ",a),o.value="âŒ Failed",setTimeout(()=>{o.value="ðŸ“‹ Copy URL"},2e3)}finally{document.body.removeChild(r)}}}};window.checkWebGLSupport=function(){try{const e=document.createElement("canvas"),o=e.getContext("webgl")||e.getContext("experimental-webgl");return o!=null}catch{return!1}};window.formatNumber=function(e,o=2){return typeof e!="number"||isNaN(e)?"0":Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"M":Math.abs(e)>=1e3?(e/1e3).toFixed(1)+"K":e.toFixed(o)};window.debounce=function(e,o){let t;return function(...r){const a=()=>{clearTimeout(t),e(...r)};clearTimeout(t),t=setTimeout(a,o)}};window.handleError=function(e,o="Operation"){console.error(`${o} failed:`,e);const t=e.message||e.toString()||"Unknown error occurred";return typeof window.showNotification=="function"?window.showNotification(`${o} failed: ${t}`,"error"):alert(`${o} failed: ${t}`),t};window.storageHelpers={set:function(e,o){try{return localStorage.setItem(e,JSON.stringify(o)),!0}catch(t){return console.warn("Failed to save to localStorage:",t),!1}},get:function(e,o=null){try{const t=localStorage.getItem(e);return t?JSON.parse(t):o}catch(t){return console.warn("Failed to read from localStorage:",t),o}},remove:function(e){try{return localStorage.removeItem(e),!0}catch(o){return console.warn("Failed to remove from localStorage:",o),!1}}};document.addEventListener("DOMContentLoaded",function(){console.log("Common utilities loaded")});
