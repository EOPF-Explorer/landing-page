const c=23283064365386963e-26,V=12,p=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),F=0,l=1,f=2,w=5;class L{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,e,r=this.length){for(;this.pos<r;){const s=this.readVarint(),n=s>>3,h=this.pos;this.type=s&7,t(n,e,this),this.pos===h&&this.skip(s)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*4294967296;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*4294967296;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const e=this.buf;let r,s;return s=e[this.pos++],r=s&127,s<128||(s=e[this.pos++],r|=(s&127)<<7,s<128)||(s=e[this.pos++],r|=(s&127)<<14,s<128)||(s=e[this.pos++],r|=(s&127)<<21,s<128)?r:(s=e[this.pos],r|=(s&15)<<28,P(r,t,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2===1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=V&&p?p.decode(this.buf.subarray(e,t)):m(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e}readPackedVarint(t=[],e){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readVarint(e));return t}readPackedSVarint(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===f?this.readVarint()+this.pos:this.pos+1}skip(t){const e=t&7;if(e===F)for(;this.buf[this.pos++]>127;);else if(e===f)this.pos=this.readVarint()+this.pos;else if(e===w)this.pos+=4;else if(e===l)this.pos+=8;else throw new Error(`Unimplemented type: ${e}`)}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;for(;e<this.pos+t;)e*=2;if(e!==this.length){const r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.dataView=new DataView(r.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*c),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*c),!0),this.pos+=8}writeVarint(t){if(t=+t||0,t>268435455||t<0){k(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))}writeSVarint(t){this.writeVarint(t<0?-t*2-1:t*2)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(t.length*4),this.pos++;const e=this.pos;this.pos=U(this.buf,t,this.pos);const r=this.pos-e;r>=128&&g(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e),this.realloc(e);for(let r=0;r<e;r++)this.buf[this.pos++]=t[r]}writeRawMessage(t,e){this.pos++;const r=this.pos;t(e,this);const s=this.pos-r;s>=128&&g(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s}writeMessage(t,e,r){this.writeTag(t,f),this.writeRawMessage(e,r)}writePackedVarint(t,e){e.length&&this.writeMessage(t,E,e)}writePackedSVarint(t,e){e.length&&this.writeMessage(t,B,e)}writePackedBoolean(t,e){e.length&&this.writeMessage(t,C,e)}writePackedFloat(t,e){e.length&&this.writeMessage(t,T,e)}writePackedDouble(t,e){e.length&&this.writeMessage(t,y,e)}writePackedFixed32(t,e){e.length&&this.writeMessage(t,M,e)}writePackedSFixed32(t,e){e.length&&this.writeMessage(t,I,e)}writePackedFixed64(t,e){e.length&&this.writeMessage(t,_,e)}writePackedSFixed64(t,e){e.length&&this.writeMessage(t,b,e)}writeBytesField(t,e){this.writeTag(t,f),this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,w),this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,w),this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,l),this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,l),this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,F),this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,F),this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,f),this.writeString(e)}writeFloatField(t,e){this.writeTag(t,w),this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,l),this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function P(i,t,e){const r=e.buf;let s,n;if(n=r[e.pos++],s=(n&112)>>4,n<128||(n=r[e.pos++],s|=(n&127)<<3,n<128)||(n=r[e.pos++],s|=(n&127)<<10,n<128)||(n=r[e.pos++],s|=(n&127)<<17,n<128)||(n=r[e.pos++],s|=(n&127)<<24,n<128)||(n=r[e.pos++],s|=(n&1)<<31,n<128))return x(i,s,t);throw new Error("Expected varint not more than 10 bytes")}function x(i,t,e){return e?t*4294967296+(i>>>0):(t>>>0)*4294967296+(i>>>0)}function k(i,t){let e,r;if(i>=0?(e=i%4294967296|0,r=i/4294967296|0):(e=~(-i%4294967296),r=~(-i/4294967296),e^4294967295?e=e+1|0:(e=0,r=r+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),S(e,r,t),D(r,t)}function S(i,t,e){e.buf[e.pos++]=i&127|128,i>>>=7,e.buf[e.pos++]=i&127|128,i>>>=7,e.buf[e.pos++]=i&127|128,i>>>=7,e.buf[e.pos++]=i&127|128,i>>>=7,e.buf[e.pos]=i&127}function D(i,t){const e=(i&7)<<4;t.buf[t.pos++]|=e|((i>>>=3)?128:0),i&&(t.buf[t.pos++]=i&127|((i>>>=7)?128:0),i&&(t.buf[t.pos++]=i&127|((i>>>=7)?128:0),i&&(t.buf[t.pos++]=i&127|((i>>>=7)?128:0),i&&(t.buf[t.pos++]=i&127|((i>>>=7)?128:0),i&&(t.buf[t.pos++]=i&127)))))}function g(i,t,e){const r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));e.realloc(r);for(let s=e.pos-1;s>=i;s--)e.buf[s+r]=e.buf[s]}function E(i,t){for(let e=0;e<i.length;e++)t.writeVarint(i[e])}function B(i,t){for(let e=0;e<i.length;e++)t.writeSVarint(i[e])}function T(i,t){for(let e=0;e<i.length;e++)t.writeFloat(i[e])}function y(i,t){for(let e=0;e<i.length;e++)t.writeDouble(i[e])}function C(i,t){for(let e=0;e<i.length;e++)t.writeBoolean(i[e])}function M(i,t){for(let e=0;e<i.length;e++)t.writeFixed32(i[e])}function I(i,t){for(let e=0;e<i.length;e++)t.writeSFixed32(i[e])}function _(i,t){for(let e=0;e<i.length;e++)t.writeFixed64(i[e])}function b(i,t){for(let e=0;e<i.length;e++)t.writeSFixed64(i[e])}function m(i,t,e){let r="",s=t;for(;s<e;){const n=i[s];let h=null,a=n>239?4:n>223?3:n>191?2:1;if(s+a>e)break;let o,d,u;a===1?n<128&&(h=n):a===2?(o=i[s+1],(o&192)===128&&(h=(n&31)<<6|o&63,h<=127&&(h=null))):a===3?(o=i[s+1],d=i[s+2],(o&192)===128&&(d&192)===128&&(h=(n&15)<<12|(o&63)<<6|d&63,(h<=2047||h>=55296&&h<=57343)&&(h=null))):a===4&&(o=i[s+1],d=i[s+2],u=i[s+3],(o&192)===128&&(d&192)===128&&(u&192)===128&&(h=(n&15)<<18|(o&63)<<12|(d&63)<<6|u&63,(h<=65535||h>=1114112)&&(h=null))),h===null?(h=65533,a=1):h>65535&&(h-=65536,r+=String.fromCharCode(h>>>10&1023|55296),h=56320|h&1023),r+=String.fromCharCode(h),s+=a}return r}function U(i,t,e){for(let r=0,s,n;r<t.length;r++){if(s=t.charCodeAt(r),s>55295&&s<57344)if(n)if(s<56320){i[e++]=239,i[e++]=191,i[e++]=189,n=s;continue}else s=n-55296<<10|s-56320|65536,n=null;else{s>56319||r+1===t.length?(i[e++]=239,i[e++]=191,i[e++]=189):n=s;continue}else n&&(i[e++]=239,i[e++]=191,i[e++]=189,n=null);s<128?i[e++]=s:(s<2048?i[e++]=s>>6|192:(s<65536?i[e++]=s>>12|224:(i[e++]=s>>18|240,i[e++]=s>>12&63|128),i[e++]=s>>6&63|128),i[e++]=s&63|128)}return e}export{L as P};
